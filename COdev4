using System;
using System.Collections.Generic;

// ÖZEL HATA SINIFI 0 ın altına düşerse hata fırlat
public class KuantumCokusuException : Exception {
    public KuantumCokusuException(string message) : base(message) { }
}

// ARAYÜZ (INTERFACE) arayüzü kullanan her sınıf AcilDurumSogutmasını kullanmak zorunda
public interface IKritik {
    void AcilDurumSogutmasi();
}

// SOYUT SINIF  Diğer maddelerin atasıdır
public abstract class KuantumNesnesi {
    public string ID { get; set; }
    public int TehlikeSeviyesi { get; set; }
    private double _stabilite;

    public double Stabilite {
        get { return _stabilite; }
        set {
            if (value > 100) _stabilite = 100;
            else if (value < 0) _stabilite = 0;
            else _stabilite = value;

            if (_stabilite <= 0) // 
                throw new KuantumCokusuException($"Nesne ID: {ID} patladı!");
        }
    }

    public abstract void AnalizEt(); // 

    public string DurumBilgisi() { // 
        return $"ID: {ID} | Stabilite: {Stabilite:F2} | Tehlike: {TehlikeSeviyesi}";
    }
}

// SOMUT SINIFLAR 
public class VeriPaketi : KuantumNesnesi {
    public override void AnalizEt() {
        Stabilite -= 5;
        Console.WriteLine("Veri içeriği okundu.");
    }
}

public class KaranlikMadde : KuantumNesnesi, IKritik {
    public override void AnalizEt() {
        Stabilite -= 15;
    }
    public void AcilDurumSogutmasi() {
        Stabilite += 50;
        Console.WriteLine($"{ID} soğutuldu.");
    }
}

public class AntiMadde : KuantumNesnesi, IKritik {
    public override void AnalizEt() {
        Stabilite -= 25;
        Console.WriteLine("Evrenin dokusu titriyor...");
    }
    public void AcilDurumSogutmasi() {
        Stabilite += 50;
        Console.WriteLine($"{ID} soğutuldu.");
    }
}

// MAIN LOOP
class Program {
    static void Main(string[] args) {
        List<KuantumNesnesi> envanter = new List<KuantumNesnesi>();
        Console.WriteLine("OMEGA SEKTÖRÜ - KUANTUM VERİ AMBARI");

        while (true) {
            try {
                Console.WriteLine("\n1. Ekle 2. Listele 3. Analiz 4. Soğut 5. Çıkış");
                Console.Write("Seçim: ");
                string secim = Console.ReadLine();

                if (secim == "1") {
                    Console.Write("Tip (1:Veri, 2:Karanlık, 3:Anti): ");
                    string tip = Console.ReadLine();
                    Console.Write("ID: ");
                    string id = Console.ReadLine();
                    
                    KuantumNesnesi kn = null;
                    if (tip == "1") kn = new VeriPaketi { ID = id, TehlikeSeviyesi = 1, Stabilite = 100 };
                    else if (tip == "2") kn = new KaranlikMadde { ID = id, TehlikeSeviyesi = 5, Stabilite = 100 };
                    else if (tip == "3") kn = new AntiMadde { ID = id, TehlikeSeviyesi = 10, Stabilite = 100 };
                    
                    if(kn != null) envanter.Add(kn);
                }
                else if (secim == "2") {
                    foreach (var item in envanter) Console.WriteLine(item.DurumBilgisi());
                }
                else if (secim == "3") {
                    Console.Write("ID: ");
                    string id = Console.ReadLine();
                    var item = envanter.Find(x => x.ID == id);
                    if (item != null) item.AnalizEt();
                }
                else if (secim == "4") {
                    Console.Write("ID: ");
                    string id = Console.ReadLine();
                    var item = envanter.Find(x => x.ID == id);
                    if (item is IKritik kritik) kritik.AcilDurumSogutmasi();
                    else Console.WriteLine("Bu nesne soğutulamaz!");
                }
                else if (secim == "5") break;

            } catch (KuantumCokusuException ex) { // 
                Console.WriteLine($"\nSİSTEM ÇÖKTÜ! TAHLİYE BAŞLATILIYOR... ({ex.Message})");
                break;
            }
        }
    }
}
